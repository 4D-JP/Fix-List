4D v17 R2
---

![jp](https://cloud.githubusercontent.com/assets/10509075/16182979/016305e0-36e7-11e6-816b-2335cc6f0abb.png)

* ACI0098386 日本語変換入力中に表示される下線の色がブラックに固定されていました。

* ACI0098038 日本語変換中は矢印キーでカーソルの位置を移動することができませんでした。

* ACI0098025 クリックイベントでカレントウィンドウのフォームが切り替わった直後，フォーカス可かつタブ不可に設定されたボタンオブジェクトにフォーカスが移動した場合，日本語入力メソッドが利用不可になりました。新規ウィンドウでダイアログが表示されたのであれば，問題ありません。フォーカスをタブ移動すれば，再び日本語入力メソッドが利用できるようになりますが，そのためには，フォーカスを得たオブジェクトがタブ可に設定されていなければなりません。

* ACI0098157 データベース言語が「日本語」に設定されており「旧バージョン互換のテキスト比較」が有効（デフォルト）にされている場合，長音記号が単純な記号としてではなく，母音を引き延ばす発音記号として検索されました。たとえば，「あんがーるず」の「ア」を置換または検索しようとした場合，「がー」の「ー」も「ア」と同等であるとみなされました。

* ACI0098129 ``LOAD VARIABLES``でオブジェクト型変数をロードするとアプリケーションがクラッシュしました。

* ACI0098261　``MODIFY SELECTION``で表示した出力フォームからダブルクリック操作で入力フォームに移行した場合，リストボックスのチェックボックスは（入力可であっても）入力不可であるかのように表示されました。

---

* ACI0097823 プリエンプティブモードで``RESOLVE POINTER``を実行すると，空の文字列が返されました。

* ACI0098163 セレクション型のリストボックスに『サブレコード追加』標準アクションでレコードを追加し，セルにタイプ入力したテキストが未確定の状態で再びレコード追加を実行すると，編集中だったセルの値が新規レコードのセルに引き継がれました。

* ACI0098213 Windows版のみ。``HTTP Get``コマンドで特定のURLにアクセスするとエラー#30（``HTTP Server unreachable``）が返されました。

* ACI0098277 環境設定でフォームエディターにデフォルトで表示されるバッジを変更した場合，エディターのツールバーに表示されるアイコンが選択されているバッジと合わないことがありました。たとえば『オブジェクトメソッド』のバッジが選択されているのに『標準アクション』のアイコンが表示されました。

* ACI009838832ビット版のみ。旧バージョンでは問題なかった，サードパーティ社製のプラグインコマンドを使用すると，終了時にアプリケーションがクラッシュしました。

**注記**: 別スレッドからプラグインSDKをコールしてハンドルを作成していることが原因です。返されたエラーコードを無視して無効なハンドルを使用しているためにクラッシュしています。修正により，別スレッドでもプラグインSDKをコールしてハンドルを作成することができるようになりました。

* ACI0097889 4D Writeプラグインで作成した文書（``4W7``）を4D Write Proで開いた場合，読み込みに時間がかかりました（``0.2``秒だったものが``0.4``秒に）。

* ACI0098363 デザインモードの『未使用のローカル変数を検索』メニューを実行した場合，コレクション型およびオブジェクト型の変数が検出されませんでした。

* ACI0094811 コマンドで作成したメニューバーに対して``RELEASE MENU``をコールしなかった場合，アプリケーションが終了時にクラッシュしました。

* ACI0094683 2個以上の要素を有する配列を使用し，インデックスが設定されたフィールドに対して``QUERY WITH ARRAY``を実行した場合，ワイルドカード文字（``@``）がヌルまたは空の文字列に対して効かず，該当する位置に少なくとも1個は文字がなければなりませんでした。インデックスが設定されていなければ問題ありません。

* ACI0097388 デザインモードの『未使用のローカル変数を検索』メニューを実行した場合，BLOB配列，オブジェクト配列，時間配列は検出されませんでした。

* ACI0097381 Mac 32ビット版のみ。``SET CURRENT PRINTER``が初回は効きませんでした（「すべてのプリンター」の設定が有効になりました）。2回目以降の印刷は問題ありません。

* ACI0097252 Windows 64ビット版のみ。ビルドしたクライアントアプリケーションをタスクバーにピン留めし，``0.8``秒以下の短い間隔で連続クリックすると，アプリケーションが二重に起動し，両方でエラーが返されました。ゆっくり操作すれば，二重に起動することはなく，また起動したインスタンスでサーバーに接続できます。

* ACI0096866 デフォルトユーザー設定が有効にされている場合，``CHANGE CURRENT USER``で切り替えたユーザー名ではなく，デフォルトのユーザー名が``LOCKED BY``から返されました。

* ACI0096656 ``IMAP_Search``を使用して``Message-ID``ヘッダーでメッセージを検索した場合，対象になるはずのメッセージが結果に含まれないことがありました。

* ACI0096115 ``On Server Startup``データベースメソッドで``SET MENU BAR``コマンドを実行すると，サーバーがクラッシュしました。

* ACI0095913 スタイル付きテキストの``<span>``の中では``text-align``属性が無視されました。

* ACI0097668 32ビット版のみ。空の``4LB``ファイルをラベルエディターで開いた場合，アプリケーションがクラッシュしました。

* ACI0097633 64ビット版のみ。ラベルエディターで``&``または``%``記号をはさんでフィールドを連結した場合，文字のフォント色が赤になりました。

* ACI0097983 Windows版のみ。サービス起動したサーバーアプリケーションは，クライアント側のサーバー管理画面（アプリケーションサーバー）の「サービス起動」が常に「いいえ」と表示されました。

* ACI0097975 オブジェクトから作成されたダイナミックフォームの実行コンテキストで``Current method name``を実行した場合，``untitled``という文字列が返されました。

* ACI0097966 64ビット版のみ。ラベルエディターの用紙設定で「横向き」を選択しても，縦向きのドキュメントがプリントアウトされました。

* ACI0097964 32ビット版のみ。データベースがアプリケーションモードで開始され，スプラッシュ画面が非表示で，アプリケーションプロセスに``SET MENU ITEM``でメニューバーが設定された場合，新規プロセスで開かれたフォームは，設定された連結メニューバーの編集メニューが効きませんでした。

* ACI0097938 Windows Server 2008 R2，Windows Server 2012のみ。特定のマシンでは``Graphics.dll``が原因でアプリケーションがクラッシュしました。

* ACI0097932 Mac版のみ。PDF画像を印刷した場合，``OPEN PRINTING JOB``および``CLOSE PRINTING JOB``コマンドでメモリーリークが発生しました。プリントジョブを終了しても，プロセスを終了するまでは印刷で使用したメモリが解放されないため，同一プロセス内で大量のページ数を印刷した場合，アプリケーションがクラッシュする恐れがありました。

* ACI0097912 クライアント/サーバー通信の暗号化が有効にされており，データベース設定でアプリケーション開始時にWebサーバーが自動的に起動するように設定されていた場合，中間証明書のチェーンが不完全となり，セキュリティ評価が下がりました。メニューやコマンドでWebサーバーを起動した場合には問題ありません。

* ACI0097895 クエリエディターでフィールドリストの項目を上下矢印キーで選択した場合，縦スクロールが効かず，表示されたリストの外にあるフィールドを選ぶことができませんでした。

* ACI0097866 SQLで4Dメソッドを呼び出した場合，ランダムにアプリケーションがクラッシュすることがありました。

**注記**:キャッシュがいっぱいになると，キャッシュの10%（デフォルト値）が強制的にパージされ，データフラッシュが発生します。このとき，データベース設定の「インタフェース」で「フラッシュの進捗状況」が有効にされていると，「ディスク書き込み」ダイアログが表示されます。このローカライズが``XLIFF``ではなく，``RSR``ファイルに由来していたため，プリエンプティブスレッドで実行されているSQLコードからスレッドセーフではないAltura Mac2Win（``ASINTPPC.dll``）のAPIが呼ばれていたことが原因でした。

* ACI0097864 システムの日付フォーマットが「ベルギー/ドイツ語（``DD-MM-YYYY``）」に設定されている場合，4Dの日付フォーマット``System date short``は年が2桁しか表示されませんでした。

* ACI0097853 リストボックスが表示されているウィンドウから，同じフォームを続けてダイアログ表示した場合，入力不可のブール型カラム（チェックボックス表示）が入力可であるかのように描画されました。

* ACI0097690 ``String``の引数として，直接，``Sum``, ``Min``, ``Max``などの統計関数を渡した場合，エラー``54``（引数の型が一致しません）が返されました。``*1``や``+0``などの演算子を添えて式の型を特定すれば問題ありません。

* ACI0098321 Mac版のみ。ビルドしたサーバー版アプリケーションでMSCの検査を実行すると，クラッシュする場合がありました。ビルドしたデスクトップ版やインタープリターモードでは問題ありません。

* ACI0098269 クライアント側で``CHANGE CURRENT USER``を実行しても，サーバー側の管理画面には（何時間経過しても）カレントユーザーの変更が反映されませんでした。

* ACI0098264 Windows 10 アップデート ``1803``以降，サービスとして登録された4D Serverの起動時にエラー``193 0xC1``が返されるようになりました。ビルドして署名したサーバーアプリケーションをサービスとして起動した場合にだけ問題が発生します。

* ACI0098253 ``&``の文字が含まれているSVG画像を``SVGTOOL_show_in_viewer``メソッドで開いた場合，エラー`` -20002``が返されました。

* ACI0098237 ``SEND RECORD``で書き出したv2004のレコードをv14以降の``RECEIVE RECORD``で読み込もうとした場合，アプリケーションがクラッシュしました。

* ACI0098236 Windows版のみ。Microsoftの[自己署名証明書](https://msdn.microsoft.com/en-us/library/windows/desktop/jj835832.aspx)を発行して[署名ツール](https://msdn.microsoft.com/en-us/library/aa387764.aspx)で64ビット版のOEMサーバーアプリケーションを署名することができませんでした。

* ACI0098223 定数``OCI_STMT_DECLARE ``の値が正しくありませんでした。``39``ではなく``9``であるべきです。

* ACI0098194 リストボックス列の幅をフォームエディターのプロパティリストに入力した後，そのリストボックスの位置やサイズを変更すると，列の幅に加えた変更が失われました。ビルド``221608``で問題が発生しました。

* ACI0098188 コンパイルモードで``Min``や``Max``などをレコードに対して使用して戻り値をポインターで逆参照された変数に代入した場合，ポインターによるタイプの再定義エラーが返されました。配列に対して統計関数を使用した場合には問題ありません。

* ACI0098184 4D Write文書に埋め込まれた``Num(...) * "..."``のような式は，4D Write Proに変換した後，正しく評価されませんでした。

* ACI0098179 64ビット版のみ。ファイルメニューの「データをファイルに書き出し」で表示されるダイアログは，自動リレーションに対応していませんでした。リレートテーブルを選択しても，マスターテーブルのフィールドが表示されました。

* ACI0098178 64ビット版のみ。``IMPORT DATA``の第1引数に空の文字列（``""``）が渡した場合，ファイル選択ダイアログが表示されませんでした。

* ACI0098002 Windows版のみ。フォームを何度も開いたり，閉じたりしていると，メニューバーが解放されるタイミングでアプリケーションがクラッシュする場合がありました。

* ACI0097994 4D Serverのライセンス（Team Developer Professionalではない）でクライアント側でシンタックスチェックや変数定義の生成を実行した場合，完了を伝えるメッセージがコンパイラー画面に表示されませんでした。

* ACI0097992 Windows版のみ。4D Write ProでTrue Typeフォントが使用できませんでした。

* ACI0097986 コンパイルモードで``SET ASSERT ENABLED``に``False``を渡した場合，カレントプロセスだけに設定が適用され，セッション全体に適用されませんでした。

* ACI0097984 アプリケーションプロセスが延期されている状態で，サーバー管理画面でユーザーをドロップした場合，クライアント側で「接続が切断されました。深刻なエラー」メッセージが表示されました。

* ACI0098063 64ビット版クイックレートエディターのタイトルに``n``の文字をタイプ入力すると，「レポートを開く（ファイル選択）」ダイアログが表示されました。

* ACI0098042 4D RemoteでWebサーバーを実行した場合，他のプロセスとの競合により，デッドロック状態に陥ることがありました。Webプロセスを初期化するときに4D Serverのユーザー＆グループ管理システムを同期させる方法に問題がありました。

* ACI0098107 4D Write Proでコンテキストメニューから用紙のサイズや方向を変更した場合，該当するコンテキストメニュー項目にチェックマークが表示されませんでした。

* ACI0098098 フランス語版は定数``Web Client IP address to listen``がローカライズ（``Web client adresse IP d’écoute``）されていませんでした。

* ACI0098094 日付配列に対して``Min``や``Max``などの統計関数が使用されていた場合，コンパイラーからエラーが返されました。

* ACI0098079 外部ファイルにレコードが保存されるようにフィールドのプロパティを設定した場合に問題がありました。レコードを削除してもファイルが自動的に削除されません。また，100件毎にサブフォルダーが作成されませんでした。

* ACI0098128 4D Write Proの文章の背後に表示されたピクチャーを``command``+クリック操作で選択することができませんでした。

**注記**: 問題はテキストのボディ部分に``id``が設定されている場合に発生しました。つまり，4D Write Proのボディに``img1``という``id``を設定し，その背後にピクチャを追加した場合，ピクチャを選択することができませんでした。

* ACI0098127 データベース設定の『Web』ページで，待ち受けIPアドレスを指定してからWebサーバーを開始したとしても，実際には『任意』，つまりすべてのIPアドレスでリクエストを受信しました。そのため，別のIPアドレス/同じポート番号で他のサーバーを起動することができず，また他のサーバーがすでに起動している場合は4DのWebサーバーを起動することができませんでした。``WEB SET OPTION``あるいは``SET DATABASE PARAMETER``で``Web IP address to listen``を指定しても結果は同じです。

* ACI0098149 プリエンプティブモードで実行中のプロセスをランタイムエクスプローラーで選択し，変数を表示させようとすると，アプリケーションがクラッシュしました。プリエンプティブモードで実行されているワーカーなどのプロセス変数は（外部から参照できない以上）入力されても無視されるべきです。

* ACI0098136 オブジェクト記法が有効にされているデータベースでシンタックスチェックまたは型定義メソッドの作成を実行した場合，アプリケーションがクラッシュすることがありました。

```
If (True)	
	TEST (${1};${2};${3}) 
End if
 ```
 
* ACI0098165 16.3以前に作成したWrite Pro文書のレコードを16R6以降で開いた場合，オブジェクトの中に属性が2個ずつ作成されました。

