4D v17.1
---

![jp](https://cloud.githubusercontent.com/assets/10509075/16182979/016305e0-36e7-11e6-816b-2335cc6f0abb.png)

* ACI0098770 日本語が入力できないようにフィルターが設定されたリストボックスのセルを編集しているときに，他のアプリケーションやデスクトップにフォーカスを移動し，4Dに復帰した場合，日本語入力モードが有効になりました。Windows版の場合，この状態でテキストを入力すると，独立したIMEウィンドウ上で文字列が編集されました。期待されるのは，日本語入力がオフになることです。

* ACI0098445 メソッドエディター上で半角カタカナが正しく表示されませんでした。たとえば，濁点付きの文字列が含まれる場合，カーソルが文字の真ん中に表示されたりしました。あるいは，行全体を選択した場合，文字列の前半だけがハイライト表示されました。

**注記**: メソッドエディター特有の固定幅表示（カーニングを使用しない）に問題がありました。

---

* ACI0098982 64ビット版のみ。``INVOKE ACTION``の``ak paste``アクションでペースト操作を実行することができませんでした。

* ACI0098967 Mac 64ビット版のみ。ウィンドウを表示しない状態で4D Serverを運用した場合，システムのAppNapによってパフォーマンスが大幅に低下しました。4D ServerにAppNapが適用されていることは，アクティビティモニターで確認することができます。

* ACI0098915 64ビット版のみ。コマンドで追加されたメニュー項目に対して``GET MENU ITEM``を使用した場合，空の文字列が返されました。メニューエディターで追加されたメニュー項目であれば問題ありません。

* ACI0098896 ``LISTBOX SELECT ROW``で選択中の行を削除した場合，リストボックスの『カレント項目位置』プロパティに正しい値が返されませんでした。``0``ではなく，エンティティセレクションのサイズが返されました。

* ACI0098812 ダウンロードパスに``ó``文字が含まれている場合，``Pop3_Download``からエラー``-120``が返されました。

* ACI0098707 64ビット版のみ。統合Webエリアにキーコンビネーションでアクセント文字を入力した場合，文字が結合されませんでした。たとえば``é``ではなく，``´´e``が入力されました。

* ACI0098683 64ビット版のみ。メニューに２本の区切り線を設定した場合，続くメニューアイテムに関連付けられたメソッドが実行されませんでした。区切り線を続けて設定した場合，システムはそれを１個の項目として扱いますが，4Dはそれを２個の項目として扱っているようです。

* ACI0098666 スクロールバーの途中をクリックしてマウスボタンを押したままにした場合，クリックした位置にスクロールが到達しても止まらず，最後（または最初）までスクロールが続きました。リストボックス・テキスト入力エリア・階層リストで問題が発生します。

* ACI0098330 64ビット版のみ。``PICT``形式の画像を``.png``などのフォーマットに変換することができませんでした。

**注記**: ドキュメントが修正されました。64ビット版の制限は，[CONVERT PICTURE](http://doc.4d.com/4Dv17/4D/17/CONVERT-PICTURE.301-3730374.ja.html)に掲載されています。``PICT``画像の変換は，『32ビット版で実行する』必要があることに留意してください。

* ACI0097739 Mac 32ビット版のみ。添付ファイル名が32文字を超える場合，``SMTP_Attachment``からエラー``-43``が返され，添付ファイル無しのメールが送信されました。

**注記**: ドキュメントが修正されました。Mac 32ビット版のファイルパスに関する制限は，[ファイル転送 - 概要](http://livedoc.4d.com/4D-Internet-Commands-15/IC/-.300-2397871.ja.html)に掲載されています。32ビット版のInternet Commandsは，Appleが2011年に``deprecated``とした``FSSpec`` APIを使用しています。現在の上限は63バイトですが，将来のバージョンでは『より厳しい制限が課せられる可能性がある』ことに留意してください。

* ACI0098969 64ビット版のみ。ユーザー認証ダイアログに表示される画像を``LoginImage.png``でカスタマイズした場合，右にある「ユーザー認証」の文字が画像によって隠されませんでした。期待されるのは，32ビット版と同じように，このテキストが表示されないことです。

* ACI0098958 Write Proドキュメントに式が挿入されている場合，``WP Get selection``から正しいレンジが返されませんでした。式から返される値の文字数が勘定されていないようです。

* ACI0098924 ``READ PICTURE FILE``コマンドでPDFファイルを読み込んで``CONVERT PICTURE``で変換した場合，メモリーリークが発生しました。

**注記**: Mac版のメモリーリークはCocoaフレームワークの``autoreleasepool``によるものでした。Windows版の場合，PDFをピクチャとして処理することはできないので，PDFからPNGをコマンドに要求した場合，元の画像がそのまま返されるべきでした。

* ACI0098902 ``WP New``コマンドに未定義のオブジェクト型を引数として渡した場合，アプリケーションがクラッシュしました。

* ACI0098872 Windows版でOEM版のサーバーアプリケーションをビルドした場合，ヘルプメニューが一番左側に表示されました。

*  ACI0098713 『サブレコード追加』標準アクションが設定されたボタンのあるダイアログから新規ウィンドウを表示した場合，そのウィンドウを閉じた後，『サブレコード追加』ボタンの``disabled``状態が解除されませんでした。

* ACI0098636 Windows版のみ。SDIモードのアプリケーションをメインディスプレイで起動し，メインディスプレイの右側に接続された別ディスプレイにもウィンドウを表示して，それぞれの画面にドロップダウンメニューを表示すると，メインディスプレイに表示されるはずのドロップダウンメニューが表示されない，メニューの再描画が非常に遅い，PC全体が遅い，ヘルプ以外のメニューが表示されない，ウィンドウの枠だけが描画される，といった深刻な不具合が発生します。PCを再起動するまで元に戻りません。

* ACI0098537 Mac 64ビット版のみ。システム環境設定でSpotlightのショートカット（``command``+``space``）を無効にした状態で，``ON EVENT CALL``を使用した場合，``command``+``space``や``command``+``à``（フランス語配列キーボード）のような操作をしたときに，ハンドラーメソッド内でシステム変数``KEYCODE``が``0``を返しました。

* ACI0098123 Windows 64ビット版のみ。サーバーの運用中にサマータイム期間が終了した場合，サーバーを再起動するまで，``Current time(*)``から返される時間がサマータイムで返されました。


* ACI0099013 ``$``が含まれるフォーミュラ式（例：``C1/$D1``）が使用されている4D Viewドキュメントを4D View Proにコンバートした場合，フォーミュラ式が正しく変換されませんでした。

* ACI0099012 特定のフォーミュラ式（例：``C1/D1``）が使用されている4D Viewドキュメントを4D View Proにコンバートした場合，フォーミュラ式が正しく変換されませんでした。

* ACI0099010 Mac 64ビット版のみ。エクスプローラーからアイテムをドラッグした場合，アプリケーションがクラッシュしました。

**注記**: macOS SDK 10.14でペーストボードの仕様が変更されたことが関係していました。

* ACI0098913 ``MODIFY SELECTION``を実行したプロセスのメニューバー再描画に問題がありました。``MODIFY SELECTION``のウィンドウを閉じた後，プロセスのメニューとウィンドウのメニューバーが合成された状態になりました。最前面アプリケーションを切り替えれば，問題が解消されます。新規プロセスで``MODIFY SELECTION``を実行すれば問題ありません。

* ACI0098641 インデックスの設定されたオブジェクト型フィールドに対してORDAでクエリを実行した場合，``IN``比較演算子でシーケンシャルクエリが実行されました。

* ACI0098981 クライアント/サーバー版のみ。すでにロックされたエンティティを同一プロセスから再度ロックしてから削除した場合，プロセス終了時にエラーが返されました。スタンドアロン版では問題ありません。
