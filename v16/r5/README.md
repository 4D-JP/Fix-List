4D v16 R5
---

![jp](https://cloud.githubusercontent.com/assets/10509075/16182979/016305e0-36e7-11e6-816b-2335cc6f0abb.png)

* ACI0092847 Mac版のみ。スタティックテキストが日本語で始まる場合，フォームエディター上で``2``ピクセルほどベースラインの位置が高く表示されました。文字列が英数字で始まる場合は問題ありません。エディター上とランタイムで位置が違うために，レイアウトの設計が面倒です。

* ACI0095298 IMEの日本語変換候補ウィンドウが表示された状態でコンボボックスのポップアップメニューを表示した場合，入力中の日本語変換が確定されず，候補ウィンドウと同時にポップアップメニューも表示されました。

* ACI0096009 ``ST SET TEXT``コマンドにメモリーリークがありました。

**注記**: 4D Write Proおよびスタイルテキストコマンド全般に影響があります。

* ACI0096117 v14で作成されたメソッドに長文のスタティック文字列が含まれている場合，バージョンアップ時に途中の文字列が失われました。

* ACI0096307 64ビット版のみ。ストラクチャエディターは，フォント名を変更しても，設定が反映されませんでした。どのフォントを選択しても``Agency FB``が設定されました。

* ACI0096875 メソッドエディター上の空行を選択した状態で``command``+``K``のキーボードショートカットを入力しても，エクスプローラーの「メソッド」ページが開きませんでした。

* ACI0096892 インポートダイアログ経由で``Windows-31J``または``Shift_JIS``エンコーディングのタブ区切りテキストファイルをインポートした場合，``tab``記号がフィールド区切り文字として処理されませんでした。

* ACI0096957 メソッドエディター上で改行されたコードの行末にある``\``記号の位置で``return``キーを入力すると，改行されたコード全体が``\``記号で終わる1行にまとめられました。

* ACI0096998 データベースに数百個のテーブルが存在する場合，``Begin SQL``/``End SQL``ブロック内で``SELECT``など，テーブル名が続くコマンドを入力すると，キーストロークの動作がとても重くなりました。

* ACI0097006 Mac版のみ。ツールボックスのリソースページで，アイテムをサムネイル表示した場合，``command``キーを押しながらアイコンをクリックしても，ファイルの選択が解除されてしまい，同時に複数のファイルを選択することができませんでした。

* ACI0097082 Windows 7のみ。複数行ではないテキスト入力エリアに表示された文字列の最後の文字がスペース（全角または半角）だった場合，小さなドット（文字と同じ色で，``¬``の左端だけがみえるような状態）が表示されました。フォントが「MSゴシック」の場合に限ります。また，上位のWindowsでは発生しません。

* ACI0097127 フォーム上で最初にフォーカスされているオブジェクトがコンボボックスだった場合，何も入力せずにエリアから移動しようとすると``On Data Change``イベントが発生しました。

* ACI0094424 メソッド名の30文字目が日本語だった場合，そのメソッドを複製すると同じ名前のメソッドが作成されました。

* ACI0097124 4D Server Windows 64ビット版のみ。新規データベースを作成すると，エラー``1010``が返されました。``MECAB.DLL``がインストールされていないためです。

---

* ACI0097370 新ネットワークレイヤーのみ。イーサネットケーブルが引き抜かれるなど，クライアント接続が不意に失われた場合， ``On Server Close Connection``データベースメソッドが実行されませんでした。

* ACI0097401 Mac 64ビット版のみ。クイックレポートエディターを閉じてから再び開くと，アプリケーションがクラッシュしました。リストボックスの再描画に問題があります。

* ACI0097184 64ビット版のみ。``GRAPH``コマンドで作成した円グラフが32ビット版とは値の表示がおおきく違いました。32ビット版は0°（12時）から時計回りに値が描画されますが，64ビット版は90°（3時）から反時計回りに値が描画されました。

**注記**: 円グラフの開始位置と方向を設定するためのオプションが追加されました。

```
Graph pie direction
Graph pie start angle
```

* ACI0096870 64ビット版のみ。クイックレポートエディター（``QR REPORT``）でレポートを出力した場合，作成した文書のパスがシステム変数``Document``に代入されませんでした。

* ACI0097312 Mac 64ビット版のみ。高速でWebエリアを何度も開閉していると，アプリケーションがクラッシュしました。

* ACI0097223 CEF版Webエリアのみ。``WA SET URL FILTERS``で設定したフィルターが``WA SET URL FILTERS``コマンドにも適用されました。URLフィルターは，コマンドに適用されないはずです。

* ACI0097216 Mac版のみ。継承されたフォームオブジェクトを``OBJECT DUPLICATE``で複製した場合，ダイアログ終了時にアプリケーションがクラッシュしました。

* ACI0095862 CEF版Webエリアのみ。``WA OPEN URL``でPDFファイルを開こうとするとアプリケーションがクラッシュしました。

* ACI0095585 すでに配列が表示されているリストボックスを``LISTBOX SET HIERARCHY``で階層表示に切り替えた場合，キーボードの上下矢印キーに対して垂直スクロールが正しく働きませんでした。

* ACI0094994 SQLのサブクエリを実行すると，サーバーがしばらく応答しませんでした。

**注記**: 内側の``SELECT``で数万件のレコードが合致した場合，``QUERY WITH ARRAY``のようなインデックス検索ではなく，シーケンシャル検索がテーブル全体に対して何度も実行していることが原因でした。

例:

```sql
SELECT callback 
FROM names 
WHERE custid IN (
	SELECT custid 
	FROM invoices 
	WHERE shipdate < '1990-01-01'
)
```

ちなみに，上記の場合，修正前であっても，サブクエリに``DISTINCT``を指定すれば，最初に返されるレコード数が絞り込まれ（``WHERE``の結果は同じ），問題を回避することができます。

```sql
SELECT callback
FROM names
WHERE custid IN (
	SELECT DISTINCT custid 
	FROM invoices 
	WHERE shipdate < '1990-01-01’
)
```

* ACI0097278 Mac版のみ。選択リストが関連づけられたリストボックス列にタブ移動して上矢印キーでポップアップメニューを表示し，``return``キーでリスト項目を確定した場合，以後，その項目が変更できなくなりました。下矢印キーでは問題ありません。

* ACI0097264 ``On Outside Call``イベントで``ACCEPT``コマンドを使用した場合，すぐにはフォームが閉じられず，次に発生したイベントで閉じられませんでした。

* ACI0097248 Mac版のみ。ボタンのクリックでフォームのページを切り替えると，すべてのフィールドにカーソルが表示されました。

* ACI0097241 32ビット版のみ。``WA Evaluate javascript``で``JQuery``コマンドを実行すると，コールスタックの最大数に達した，というエラーメッセージが返されました。

* ACI0097219 Mac 64ビット版のみ。``On Load``フォームイベント中に``ERASE WINDOW``, ``GOTO XY``, ``MESSAGE``コマンドを実行すると，アプリケーションがクラッシュしました。

* ACI0097201 Mac版のみ。SQLの``SELECT``コマンドに``ORDER BY``が指定された場合，あるいはサーバー/クライアントモードで``INTO``が使用された場合，メモリーリークが発生しました。

* ACI0097179 ピクチャフィールドの保存先が「データファイルの外」に設定されており，トリガで``SET EXTERNAL DATA PATH``および``WRITE PICTURE FILE``でカスタムパスにファイルが書き出されている場合，クライアントで更新されたフィールドの内容がサーバーを再起動するまで別のクライアントでは表示されませんでした。

* ACI0097096 リストボックスのセルに入力中，他のウィンドウをアクティブにしてから当初のウィンドウに戻った場合，編集中のセルに入力を続けることができますが，カーソルが表示されませんでした。

* ACI0097094 64ビット版のみ。旧ラベルエディターで作成したラベル定義ファイル（``.4LB``）を新ラベルエディターで開き，ピクチャフィールドを右クリックすると，XMLコマンドのエラーメッセージが表示されました。

* ACI0097089 フォーミュラーの中で使用しても良いメソッドを``SET ALLOWED METHOD``で登録しても，サーバー側では，それらのメソッドを使用することができませんでした。そのため，サーバー側で4D Write Proの差し込みドキュメントを出力する，といったことができませんでした。

* ACI0097083 非表示フィールドが存在するテーブルのフィールドに``SET FIELD TITLES``でバーチャル名を設定されている場合，4D Write文書にフィールド参照を挿入すると，意図したのではないフィールドが参照されました。

* ACI0097063 64ビット版のみ。JOINを活用した複雑なSQLを続けて実行していると，サーバーアプリケーションがクラッシュすることがありました。

* ACI0097059 Mac版のみ。デザインモードのテーブルリストが非アクティブなときにマウスのスクロールボタンで行を移動させてから行を選択すると，クリックと同時にスクロール位置が元に戻ってしまい，結果的に間違ったテーブルが選択されました。

* ACI0097052 32ビット版のみ。旧クイックレポートの幅には，非表示に設定されたカラムの幅も含まれていました。v13までは，非表示にされたカラムの幅は，レポートの幅に含まれませんでした。

* ACI0097034 ``SQL EXECUTE``コマンドでカッコ文字（例：`` '(a)'``）が含まれる値を``INSERT``命令で外部SQLサーバーに対して送信しようとすると，エラーが返されました。

* ACI0097031 Windows版のみ。印刷のページ範囲が「すべて」に設定されている場合，つまり，「ページ1から（指定なし）まで」に設定されている場合，``BLOB to print settings``は印刷のページ範囲を「すべて」ではなく「ページ1から1まで」に設定しました。

* ACI0097026 文字列フィールドに対して``Max``関数を使用した場合，メモリーリークが発生しました。

* ACI0097025 ``DISPLAY SELECTION``コマンドで表示中のリスト画面を再描画する目的で，再度``DISPLAY SELECTION``コマンドを使用した場合，Windowsでは，リスト画面のウィンドウが最前面に移動し，Macでは，最前面のウィンドウが非アクティブになりました。期待されるのは，単純にリスト画面が再描画されることです。オブジェクトのフォーカスやウィンドウの前後関係は影響を受けるべきではありません。

* ACI0097003 リストボックスの列には，選択リストを関連付けることができますが，時間型フィールドの場合，リスト上で選択した値が正しく代入されませんでした。たとえば`` 12:00:00``のような項目を選択すると``00:02:00``が代入され，``13:00:00``のような項目を選択すると``00:02:10``が代入されました。

* ACI0096985 ``Designer``にパスワードが設定されているアプリケーションを「アプリケーションテスト」モードで実行中に終了すると，再開時はそれまで開いていたウィンドウがすべて閉じられた状態からスタートしました。期待されるのは，それまで開かれてたウィンドウが再び開かれることです。

* ACI0096974 ツールボックスのリソースページで複数の項目をまとめて削除しようとすると，空の確認ダイアログが表示されました。

* ACI0096971 Mac 32ビット版のみ。列の自動リサイズが設定されたリストボックスが含まれるサブフォームウィジェットが存在するフォームをエディターで開いた場合，そのフォームを閉じることも，オブジェクトを選択することもできませんでした。列の自動リサイズが設定されていなければ問題ありません。

* ACI0096950 ``FTP_Send``コマンドで``2.3``GBを超えるファイルを送信することができませんでした。

* ACI0096943 リストボックスの幅に表示が収まらない列が出現するよう，水平方向に少しだけスクロールし，そのセルを編集した後，別のセルをクリックすると，リストボックスの水平スクロール位置が左いっぱいまで戻されました。クリックした列は完全に表示されているので，この場面で水平スクロールは不要なはずです。

* ACI0096939 Mac版のみ。4D Writeプラグインエリア内でテキストのドラッグ＆ドロップ操作を実行すると，アプリケーションがクラッシュしました。

* ACI0096937 Windows版のみ。リストフォーム内で``On Display Detail``イベントが処理されている場合，マウスのロールボタンによるスクロールが少し遅くなります。その状態でスクロール中に右クリックイベントを処理し，``Pop up menu``でポップアップメニューを表示すると，アプリケーションが終了しました。

* ACI0096931 Windows版のみ。``LISTBOX SET ROW HEIGHT``コマンドを使用した後，内容が複数行にまたがる行をクリックした場合，行全体が選択されないことがありました。クリックしたセルだけがハイライト表示され，それまで選択されていた行のハイライト表示が解除されませんでした。

* ACI0096886 Mac 64ビット版のみ。Dockに表示されている4Dのアイコンを右クリックし，コンテキストメニューを表示した場合，4Dが開いているウィンドウのリストが表示されませんでした。

* ACI0096881 64ビット版のみ。"Arial Narrow"など，DirectWrite系のフォントファミリーは印刷またはプレビューに反映されませんでした。また，4D View Pro版の新リストボックス（クイックレポートエディターなど）では画面にも反映されませんでした。

* ACI0096876 4D Write Proのアンダーラインや取り消し線の幅（太さ）と位置が正しくないことがありました。線幅は，フォントサイズとフォント名だけで決まるべきですが，スタイル（ボールド）や方向（右から左）などには影響されるべきではありません。

* ACI0096871 ``HTTP Get``の前に``HTTP AUTHENTICATE``コマンドで``Digest Authentication``を使用してApacheサーバーに接続した場合，URIにクエリ文字列が含まれていると，URIの不一致エラーが返されました。

* ACI0096856 Internet Commandsで送信したメールをiOSデバイス（iPhoneまたはiPad）で受信した場合，添付のPDFファイルが表示されませんでした。Outlookなどのメールクライアントでは問題ありません。

* ACI0096853 リストボックス（セレクションまたは配列タイプ）の水平リサイズオプションが「拡大」に設定されている場合，セルの入力中にリストボックスをリサイズすると，テキスト編集エリアが正しくリサイズされませんでした。

* ACI0096842 クライアント側で「サーバーに接続」ダイアログ画面で上下矢印キーを使用してサーバーを選択した場合は「OK」ボタンがアクティブ状態になりませんでした。クリック操作でサーバーを選択した場合は問題ありません。

* ACI0096836 Mac 64ビット版のみ。「定義を開く」コマンドで指定したプロジェクトメソッドがすでにDock内に最小化されていた場合，メソッドのウィンドウが最大化されませんでした。

* ACI0096818 4D Serverに接続した後，スリープに移行した時とは別のIPアドレスでクライアントマシンのスリープを解除した場合，クライアントが新しいユーザーとしてサーバーに再接続し，以前の接続が解放されませんでした。

* ACI0096804 フォルダー内に多数の項目が含まれる場合，``FTP_GetDirList ``が処理を完了するまで非常に時間がかかりました。以前のバージョンでは``0.250``秒ほどかかった処理が，Macでは数秒，Windowsでは数分を要しました。

* ACI0096790 Windows版のみ。リストボックスのブール型フィールド（表示フォーマットがチェックボックスまたはポップアップ）が印刷に反映されませんでした。

* ACI0096763 ``HTTP request``コマンドでプロキシの向こう側のサーバーにHTTPSでアクセスしようとすると，エラー``23``が返されましたHTTPでは問題ありません。

* ACI0096758 ``HTTP FIXER OPTION``コマンドで``HTTP compression``を``1``に変更しても，設定が反映されませんでした。

* ACI0096625 Windows版のみ。キリル文字など，標準的な英数字以外がパスに含まれる場合，``The ICU framework is malformed. Please verify 4D installation.``というエラーが表示され，4Dが正常に起動できませんでした。

* ACI0096320 64ビット版のみ。フォームエディターは，プロパティリストで印刷設定ボタンをクリックすると，プロパティリストが消え，印刷設定ダイアログを閉じた後もプロパティリストが再表示されませんでした。デスクトップをクリックするなどして，明示的にアプリケーションを最前面に移動すれば，プロパティリストが再表示されます。

* ACI0096277 Mac版のみ。4D Write Pro文書のインデント後，左マージンの手前に挿入されたタブは無視されました。つまり，``tab``キーを押しても，その位置に挿入ポイントがセットされず，左マージンまで移動しました。

* ACI0096165 Windows版のみ。英語版のオペレーションシステムで地域と言語を「トルコ語」に設定した場合，サーバー管理画面のボタンがクリックに反応しませんでした。

* ACI0096073 Mac版のみ。ピクチャオブジェクト間の自動ドラッグ/ドロップ操作が完了するまでに数秒かかりました。

* ACI0096039 OEMビルド版のみ。サービス起動した4D Serverの``On Server Startup``データベースイベントでで``SET ABOUT``コマンドを実行すると，アプリケーションがクラッシュしました。OEM（ライセンス埋め込み）ビルドの4D Serverでなければ，問題ありません。また，「デスクトップとの対話がサービスに許可されていれば，問題ありません。

* ACI0096028 クライアント/サーバー版のみ。クライアント側でSQLの``INSERT``文で``ARRAY BLOB``をフィールドに代入しようとすると，エラー``1111``が返されました。

* ACI0096026 クライアント/サーバー版のみ。クライアント側でSQLの``INSERT``文で``ARRAY TIME``をフィールドに代入しようとすると，エラー``1013``が返されました。

* ACI0095039 ``ARRAY BLOB``で明示的に宣言されていないBLOB配列に対して``Type``関数を使用した場合，インタープリターモードでは``31`` (``Blob array``) が返されますが，コンパイルモードでは``19`` (``Picture array``) が返されました。

* ACI0093293 Mac版のみ。メソッドエディターのツールバーに統合されている検索フィールドの履歴ボタンをクリックしても，過去の実行した検索のポップアップメニューが表示されませんでした。

* ACI0097302 64ビット版のみ。``MSG_GetBody``および``MSG_Extract``は，メールの解析に32ビット版よりもずっと長い処理時間を要しました。

* ACI0097222 任意のパラメーターであるはずのフッター名およびフッター変数を省略した場合，``LISTBOX INSERT COLUMN``, ``LISTBOX DUPLICATE COLUMN``, ``LISTBOX INSERT COLUMN FORMULA``でセレクション型のリストボックスにで同時に複数の列を追加することができませんでした。2個目以降の列はフッターのオブジェクト名が空になりました。ヌルポインターを使用し，パラメーターを省略しなければ問題ありません。

* ACI0096025 階層リストボックスが表示されているフォームのページから別のページに移動し，``LISTBOX SELECT ROW``を実行した場合，意図したのとは違う行にコマンドが適用されました。その後，`LISTBOX Get number of rows``を使用した場合，実際の行数に階層のノード行を加えた数が返されました。どちらのページでコマンドを実行しても，動作は同じであるべきです。

* ACI0097495 メソッドエディターの階層を展開・収縮するノードアイコンを非表示に設定した場合，アイコンにマウスポインターを重ねて``option``キーを押すとアプリケーションがクラッシュしました。

* ACI0095136 メソッドエディターで``Case of``構文の``Else``や``:``などの中間ブロックにコードをタイプ入力しようとすると，アプリケーションがクラッシュしました。挿入位置直前（上部）の条件ブロックが畳まれている場合に問題が発生します。``If``構文の条件が畳まれた状態で``Else``ブロックを編集しようとした場合にも同じ問題が発生します。

* ACI0097399 ``WEB SERVICE CALL``を連続して使用すると，2度目の実行でエラー``9911``が返されました。

* ACI0097322 Mac 64ビット版のみ。Unlimited Desktopでビルドしたアプリケーションでは，``GRAPH``コマンドから常に空の画像を返されました。
