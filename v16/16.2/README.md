## 4D v16.2

[4D v16.1 Hotfix 1](https://github.com/4D-JP/release-notes/blob/master/v16/16.1/hf1/)および[4D v16.1 Hotfix 2](https://github.com/4D-JP/release-notes/blob/master/v16/16.1/hf2/)の修正事項もご覧ください。

![jp](https://cloud.githubusercontent.com/assets/10509075/16182979/016305e0-36e7-11e6-816b-2335cc6f0abb.png)

* ACI0096304 Windows版のみ。フォームエディターの左側に配置されているオブジェクトツールボタンの右側をクリックし，ポップアップメニューを表示させた後，ポップアップメニュー以外をクリックしてサブメニューをキャンセルしようとすると，フォームエディター全体が閉じられました。

* ACI0096601 Mac 64ビット版のみ。モーダルウィンドウの枠や影が表示されませんでした。

* ACI0096009 ``ST SET TEXT``コマンドにメモリーリークがありました。

**注記**: 4D Write Proおよびスタイルテキストコマンド全般に影響があります。

---

* ACI0095199 4D Write Proエリアが含まれるフォームをコンパイルしようとすると，「標準アクションが設定されたボタンオブジェクトに名前がありません」という趣旨のエラーメッセージが表示されました。

* ACI0097128 Mac 64ビット版のみ。ツールボックスのメニューバーエディターで項目に追加したアイコンが表示されませんでした。

* ACI0097109 ``APPEND TO ARRAY``でリストボックスに1行目を追加した後，その行が選択できませんでした。2行目以上追加すれば，問題ありません。

* ACI0097059 Mac版のみ。デザインモードのテーブルリストが非アクティブなときにマウスのスクロールボタンで行を移動させてから行を選択すると，クリックと同時にスクロール位置が元に戻ってしまい，結果的に間違ったテーブルが選択されました。

* ACI0096842 クライアント側で「サーバーに接続」ダイアログ画面で上下矢印キーを使用してサーバーを選択した場合は「OK」ボタンがアクティブ状態になりませんでした。クリック操作でサーバーを選択した場合は問題ありません。

* ACI0097063 64ビット版のみ。JOINを活用した複雑なSQLを続けて実行していると，サーバーアプリケーションがクラッシュすることがありました。

* ACI0095563 64ビット版のみ。``GRAPH``コマンドで出力したグラフは，32ビット版で出力されたものとあまりにも違い過ぎました。たとえば，時間の表示は32ビット版の``PT5H15M10S``に対し，64ビット版は``05:15:10``でした。また，要素の自動[id](http://doc.4d.com/4Dv16R3/4D/16-R3/GRAPH.301-3218870.ja.html)属性は，32ビット版の``ID_y_Values``に対し，64ビット版は``ID_y$Value``でした。

**注記**: 64ビット版の``GRAPH``コマンドは内部的に``PROCESS 4D TAGS``とテンプレートを使用しています。32ビット版は，``XSLT``を使用していました64ビット版は，``Resources``フォルダー内に``GraphTemplates``が存在する場合，そちらのテンプレートを優先的に使用します。つまり，出力されるグラフをカスタマイズすることができます。

* ACI0097053 新ネットワークレイヤーのみ。サーバーに接続した後，``On Startup``ですぐに``QUIT 4D``を実行すると，サーバー側で``On Server Close Connection``データベースメソッドが実行されますが，これに``45``秒から``90``秒ほどを要していると，途中で接続が失われ，メソッドを完了することができませんでした。

* ACI0097044 バックアップ中に表示される進捗ダイアログの停止ボタンをクリックすると，ランタイムエラーが表示されました。

* ACI0096237 メソッドエディターのツールバーに表示されている番号付きクリップボードのヘルプTips正しくありませんでした。Macの場合，``command``+``shift``+``1``などと表示されますが，実際のショートカットは``command``+``option``+``1``です。Windowsの場合，``command``+``shift``+``1``などと表示されますが，実際のショートカットは``Control``+``Alt``+``1``です。

* ACI0096974 ツールボックスのリソースページで複数の項目をまとめて削除しようとすると，空の確認ダイアログが表示されました。

* ACI0096971 Mac 32ビット版のみ。列の自動リサイズが設定されたリストボックスが含まれるサブフォームウィジェットが存在するフォームをエディターで開いた場合，そのフォームを閉じることも，オブジェクトを選択することもできませんでした。列の自動リサイズが設定されていなければ問題ありません。

* ACI0096931 Windows版のみ。``LISTBOX SET ROW HEIGHT``コマンドを使用した後，内容が複数行にまたがる行をクリックした場合，行全体が選択されないことがありました。クリックしたセルだけがハイライト表示され，それまで選択されていた行のハイライト表示が解除されませんでした。

* ACI0097026 文字列フィールドに対して``Max``関数を使用した場合，メモリーリークが発生しました。

**注記**: 文字列フィールドに対して``Max``関数が使用できるとは，ドキュメントに記述されていませんが，``Timestamp``の導入により，時間型を文字列に切り替えたいと考えるデベロッパーがいるかもしれません。

* ACI0097006 Mac版のみ。ツールボックスのリソースページで，アイテムをサムネイル表示した場合，``command``キーを押しながらアイコンをクリックしても，ファイルの選択が解除されてしまい，同時に複数のファイルを選択することができませんでした。

* ACI0096886 Mac 64ビット版のみ。Dockに表示されている4Dのアイコンを右クリックし，コンテキストメニューを表示した場合，	4Dが開いているウィンドウのリストが表示されませんでした。

* ACI0096885 ``HIDE WINDOW``でウィンドウを非表示にした後，``WINDOW LIST``を使用した場合，隠されたウィンドウの参照がリストに含まれませんでした。

**注記**: 非表示ウィンドウがリストに含まれないのは仕様です。この点は[ドキュメント](http://livedoc.4d.com/--16/-/WINDOW-LIST.301-3036368.ja.html)に明記されました。

* ACI0097031 Windows版のみ。印刷のページ範囲が「すべて」に設定されている場合，つまり，「ページ1から（指定なし）まで」に設定されている場合，``BLOB to print settings``は印刷のページ範囲を「すべて」ではなく「ページ1から1まで」に設定しました。

* ACI0096997 Windows 10のみ。新しく利用できるようになった地域と言語の設定，たとえば，英語（ベルギー），英語（インターナショナル）などのプラットフォームでは，4Dを起動することができませんでした。

**注記**: Windows Language Code Identifier (LCID) の詳細については，[MSDN](https://msdn.microsoft.com/en-us/library/cc233965.aspx)の資料をご覧ください。

* ACI0096713 クライアント接続数``2``がインストールされた4D Serverに対し，``SQL LOGIN`` ×``2``の接続を確立し，その状態でしばらく待っていると，SQL接続がタイムアウトし，SQL接続数が``0``に戻ります。しかし，アプリケーションサーバーの接続数はこのタイミングで減らないので，続けてサーバーのネットワークを切断（たとえばケーブルが抜くなど）してから元に戻した場合，ライセンス数の上限により，``SQL LOGIN``で同じサーバーに接続することができませんでした。

**注記**: 修正により，``SQL LOGOUT``が実行されない限り，SQL接続が単独で切断されることはなくなりなりました。ネットワークに障害が発生した場合，残されたSQL接続は障害発生の2時間後に解放されます。また，アプリケーションサーバーの接続数は，SQL接続が解放されると同時にリセットされます。

* ACI0096939 Mac版のみ。4D Writeプラグインエリア内でテキストのドラッグ＆ドロップ操作を実行すると，アプリケーションがクラッシュしました。

* ACI0095039 ``ARRAY BLOB``で明示的に宣言されていないBLOB配列に対して``Type``関数を使用した場合，インタープリターモードでは``31`` (``Blob array``) が返されますが，コンパイルモードでは``19`` (``Picture array``) が返されました。

**注記**: ``SELECTION TO ARRAY``コマンドを使用することにより，暗黙的にBLOB配列を宣言できることがあります。

* ACI0097156 Windows 10 (1703) のみ。English (International) などの特殊な地域と言語に設定されている場合，アプリケーションを開始することができませんでした。

**注記**: ACI0096997は，English (Belgium) 設定に対応するものでした。

* ACI0097089 フォーミュラーの中で使用しても良いメソッドを``SET ALLOWED METHOD``で登録しても，サーバー側では，それらのメソッドを使用することができませんでした。そのため，サーバー側で4D Write Proの差し込みドキュメントを出力する，といったことができませんでした。

* ACI0096985 ``Designer``にパスワードが設定されているアプリケーションを「アプリケーションテスト」モードで実行中に終了すると，再開時はそれまで開いていたウィンドウがすべて閉じられた状態からスタートしました。期待されるのは，それまで開かれてたウィンドウが再び開かれることです。

* ACI0097094 64ビット版のみ。旧ラベルエディターで作成したラベル定義ファイル（``.4LB``）を新ラベルエディターで開き，ピクチャフィールドを右クリックすると，XMLコマンドのエラーメッセージが表示されました。

* ACI0097017 Windows 10 (1703) のみ。``WR DELETE OFFSCREEN AREA``コマンドを実行しても，オフスクリーンエリアのメモリが解放されませんでした。Windows 10 (1607) および Windows 10 (1511) では問題ありません。オペレーションシステムのメモリ管理が"強化"され，マシンを再起動するまで，解放したメモリが再利用できなくなったようです``WR BLOB TO AREA``でも同じ現象が発生します。

**注記**: Microsoftのアップデート[KB4025342](https://support.microsoft.com/ja-jp/help/4025342/windows-10-update-kb4025342) が適用されている必要があります。

* ACI0096691 ``BUILD APPLICATION``コマンドのプロジェクト設定で「スタンドアロン版」と「コンパイルアプリケーション（``.4DC``）」の両方を選択した場合，選択したVolume Desktopのビット数に対応するコードだけが含まれる``.4DC``が作成されました。たとえば，32ビット版のVolume Desktopを選択した場合，32ビット版の``.4DC``が作成され，64ビット版では開くことができませんでした。``.4DC``ファイルには，32ビットと64ビットのコードが含まれるべきです。デザインモードのダイアログでアプリケーションビルドを実行した場合は問題ありません。また「スタンドアロン版」が選択されていなければ問題ありません。

* ACI0096039 OEMビルド版のみ。サービス起動した4D Serverの``On Server Startup``データベースイベントでで``SET ABOUT``コマンドを実行すると，アプリケーションがクラッシュしました。OEM（ライセンス埋め込み）ビルドの4D Serverでなければ，問題ありません。また，「デスクトップとの対話がサービスに許可されていれば，問題ありません。

* ACI0097164 ビルドしたクライアント/サーバー版のアプリケーションを起動し，1回，クライアントからサーバーに接続した後，自動アップグレードの条件が満たされるよう，ビルド設定でバージョン番号をインクリメントしてアプリケーションを再ビルドすると，古いクライアントの起動後に自動アップグレード確認ダイアログが表示されますが，そのまま操作を進めると，サーバーがクラッシュしました。

* ACI0097160 ピクチャーボタンの画像を``OBJECT SET FORMAT``コマンドで設定した場合（下記参照）の動きが変でした。本来であれば，マウスオーバー時・クリック時に4ステート画像が切り替わるはずですが，実際には，クリックするたびに画像が切り替わりました。フォームエディターのプロパティリストで画像を設定した場合は問題ありません。

```
GET PICTURE FROM LIBRARY("cancel.png";buttonPicture) 
OBJECT SET FORMAT(*;"button";"1;4;buttonpicture") 
```

* ACI0097052 32ビット版のみ。旧クイックレポートの幅には，非表示に設定されたカラムの幅も含まれていました。v13までは，非表示にされたカラムの幅は，レポートの幅に含まれませんでした。

**注記**: 原因は，「カラム幅の自動計算」が印刷に適用されていなかったことで，非表示カラムに特別なことはありませんでした。

* ACI0097025 ``DISPLAY SELECTION``コマンドで表示中のリスト画面を再描画する目的で，再度``DISPLAY SELECTION``コマンドを使用した場合，Windowsでは，リスト画面のウィンドウが最前面に移動し，Macでは，最前面のウィンドウが非アクティブになりました。期待されるのは，単純にリスト画面が再描画されることです。オブジェクトのフォーカスやウィンドウの前後関係は影響を受けるべきではありません。
