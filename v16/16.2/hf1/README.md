## 4D v16.2 Hotfix 1

![jp](https://cloud.githubusercontent.com/assets/10509075/16182979/016305e0-36e7-11e6-816b-2335cc6f0abb.png)

* ACI0092847 Mac版のみ。スタティックテキストが日本語で始まる場合，フォームエディター上で``2``ピクセルほどベースラインの位置が高く表示されました。文字列が英数字で始まる場合は問題ありません。エディター上とランタイムで位置が違うために，レイアウトの設計が面倒です。

**注記**: フォームエディターのスタティックテキスト（文字列が日本語で始まる場合）およびランタイムのリストボックス（最終行あるいは唯一の行が日本語のみで構成される場合）の処理が修正されています。

* ACI0097082 Windows 7のみ。複数行ではないテキスト入力エリアに表示された文字列の最後の文字がスペース（全角または半角）だった場合，小さなドット（文字と同じ色で，``¬``の左端だけがみえるような状態）が表示されました。フォントが「MSゴシック」の場合に限ります。また，上位のWindowsでは発生しません。

* ACI0096892 インポートダイアログ経由で``Windows-31J``または``Shift_JIS``エンコーディングのタブ区切りテキストファイルをインポートした場合，``tab``記号がフィールド区切り文字として処理されませんでした。

* ACI0095298 IMEの日本語変換候補ウィンドウが表示された状態でコンボボックスのポップアップメニューを表示した場合，入力中の日本語変換が確定されず，候補ウィンドウと同時にポップアップメニューも表示されました。

* ACI0093293 Mac版のみ。メソッドエディターのツールバーに統合されている検索フィールドの履歴ボタンをクリックしても，過去の実行した検索のポップアップメニューが表示されませんでした。

---

* ACI0097341 クライアント側でユーザー認証ダイアログ（ログイン画面）をキャンセルすると，サーバー側のユーザーリストに無名の接続が残され，接続ライセンス数が消費されたままになりました。

* ACI0096646 HTTPサーバーとHTTPクライアントを併用した場合，HTTPクライアントの速度が遅くなりました。

* ACI0096165 Windows版のみ。英語版のオペレーションシステムで地域と言語を「トルコ語」に設定した場合，サーバー管理画面のボタンがクリックに反応しませんでした。

**注記**: トルコ語では，「大文字と小文字を区別しない」文字列比較であっても，大文字の``I``と小文字の``i``が区別されます。サーバーの管理画面には``MONI``というフォームオブジェクトがあり，これを``moni``という文字列では参照できないことが関係しています。こうした問題はアプリケーション全般で起こり得るので，英語版のWIndowsをトルコ語の設定で使用することは避けるようにしてください。

* ACI0094836 日付型の変数を日付入力ウィジェットに関連付けた場合，フォームを開く前にセットされていた変数の値がフォームを実行すると初期化されました。

* ACI0097353 クライアント側でレコードを開いた状態で，サーバー側のネットワークケーブルを外し，ユーザーリストからクライアントが消えるまで待ってからケーブルを再接続し，クライアント側で別のレコードをロードしようとすると，アプリケーションがフリーズしました。

* ACI0097297 コンパイルモードでは，変数名にフィールドが設定されているポップアップメニューやコンボボックスのオブジェクトメソッドが実行されませんでした。単純な変数名では問題ありません。

* ACI0097278 Mac版のみ。選択リストが関連づけられたリストボックス列にタブ移動して上矢印キーでポップアップメニューを表示し，``return``キーでリスト項目を確定した場合，以後，その項目が変更できなくなりました。下矢印キーでは問題ありません。

* ACI0097241 32ビット版のみ。``WA Evaluate javascript``で``JQuery``コマンドを実行すると，コールスタックの最大数に達した，というエラーメッセージが返されました。

**注記**: JavaScriptのオブジェクトが返された場合，4DはこれをJSON（オブジェクトまたはテキスト）にシリアライズしますが，``JQuery``から返されたDOMオブジェクトなど，これが無限に再帰的な式となることがあります。そのような式は無限に評価されないよう修正されましたが，パフォーマンスを意識するのであれば，4D内では役に立たないDOMオブジェクトなどではなく，真偽値などを返すように心がけてください。

* ACI0096695Mac 64ビット版のみ。``On Load``イベントで``DIALOG``コマンドを使用すると，画面が再描画でちらつきました。

**注記**: ``DIALOG``を連続コールした場合に問題が発します。修正により，``On Load``のイベント処理中は，``0.2``秒ほどしてからウィンドウが再描画されるようになりました。つまり，``On Load``のイベントに``0.2``秒以上を要すると，やはり画面がちらつくように再描画されることになります。そのような場合は``On Load``や``DIALOG``の使い方を見直したほうが良いでしょう。

* ACI0097135 特定の条件下では，``SVG Find element IDs by rect``がSVG要素IDの配列を返しませんでした。

* ACI0097253 ``POP3_SetPrefs``に渡したパス名にウムラウト記号が含まれていると，エラー``-120``が返されました。

* ACI0097119 Mac 64ビット版のみ。ストラクチャエディター上でリレーションを設定する場合，描画中に水平スクロールが発生すると，アプリケーションがクラッシュしました。

* ACI0096836 Mac 64ビット版のみ。「定義を開く」コマンドで指定したプロジェクトメソッドがすでにDock内に最小化されていた場合，メソッドのウィンドウが最大化されませんでした。

* ACI0096028 クライアント/サーバー版のみ。クライアント側でSQLの``INSERT``文で``ARRAY BLOB``をフィールドに代入しようとすると，エラー``1111``が返されました。

* ACI0096026 クライアント/サーバー版のみ。クライアント側でSQLの``INSERT``文で``ARRAY TIME``をフィールドに代入しようとすると，エラー``1013``が返されました。

* ACI0096957 メソッドエディター上で改行されたコードの行末にある``\``記号の位置で``return``キーを入力すると，改行されたコード全体が``\``記号で終わる1行にまとめられました。

* ACI0096836 Mac 64ビット版のみ。「定義を開く」コマンドで指定したプロジェクトメソッドがすでにDock内に最小化されていた場合，メソッドのウィンドウが最大化されませんでした。

* ACI0097236 ツールボックスの「リスト」ページを開くと，リストの参照番号が``1``から振り直されることがありました。

* ACI0097179 ピクチャフィールドの保存先が「データファイルの外」に設定されており，トリガで``SET EXTERNAL DATA PATH``および``WRITE PICTURE FILE``でカスタムパスにファイルが書き出されている場合，クライアントで更新されたフィールドの内容がサーバーを再起動するまで別のクライアントでは表示されませんでした。

* ACI0096950 ``FTP_Send``コマンドで``2.3``GBを超えるファイルを送信することができませんでした。

* ACI0096812 クライアント側で接続の切断エラーが検出された場合，「リクエストの送信中に深刻なエラーが発生した」という大袈裟なエラーメッセージが表示されました。再接続が必要なだけであり，深刻なことは何もないはずです。

* ACI0097201 Mac版のみ。SQLの``SELECT``コマンドに``ORDER BY``が指定された場合，あるいはサーバー/クライアントモードで``INTO``が使用された場合，メモリーリークが発生しました。

* ACI0097295 Windows版のみ。サービスとして起動された4D Server上で``ALERT``のようなダイアログ表示コマンドを使用したり，範囲チェックエラー（ダイアログの表示を抑制することができない）が返されたりすると，サーバーがブロックされたようになりました。「デスクトップとの対話」が無効にされたサービスの場合，サーバー側ではダイアログの表示が全面的に回避されるべきです。

* ACI0097248 Mac版のみ。ボタンのクリックでフォームのページを切り替えると，すべてのフィールドにカーソルが表示されました。

* ACI0097219 Mac 64ビット版のみ。``On Load``フォームイベント中に``ERASE WINDOW``, ``GOTO XY``, ``MESSAGE``コマンドを実行すると，アプリケーションがクラッシュしました。

* ACI0097096 リストボックスのセルに入力中，他のウィンドウをアクティブにしてから当初のウィンドウに戻った場合，編集中のセルに入力を続けることができますが，カーソルが表示されませんでした。

* ACI0097083 非表示フィールドが存在するテーブルのフィールドに``SET FIELD TITLES``でバーチャル名を設定されている場合，4D Write文書にフィールド参照を挿入すると，意図したのではないフィールドが参照されました。

* ACI0097003 リストボックスの列には，選択リストを関連付けることができますが，時間型フィールドの場合，リスト上で選択した値が正しく代入されませんでした。たとえば`` 12:00:00``のような項目を選択すると``00:02:00``が代入され，``13:00:00``のような項目を選択すると``00:02:10``が代入されました。

* ACI0096277 Mac版のみ。4D Write Pro文書のインデント後，左マージンの手前に挿入されたタブは無視されました。つまり，``tab``キーを押しても，その位置に挿入ポイントがセットされず，左マージンまで移動しました。

* ACI0096998 データベースに数百個のテーブルが存在する場合，``'Begin SQL``/``End SQL``ブロック内で``SELECT``など，テーブル名が続くコマンドを入力すると，キーストロークの動作がとても重くなりました。

* ACI0096943 リストボックスの幅に表示が収まらない列が出現するよう，水平方向に少しだけスクロールし，そのセルを編集した後，別のセルをクリックすると，リストボックスの水平スクロール位置が左いっぱいまで戻されました。クリックした列は完全に表示されているので，この場面で水平スクロールは不要なはずです。

* ACI0096875 メソッドエディター上の空行を選択した状態で``command``+``K``のキーボードショートカットを入力しても，エクスプローラーの「メソッド」ページが開きませんでした。

**注記**: 問題は，「ファイル > 開く > メソッド」および「メソッド > 定義を開く」のメニューに同じキーボードショートカットが設定されていることでした。v15以前の動作を再現するため，メソッドエディターの「定義を開く」メニューはいつでも実行できるようになり，また，空行が選択された状態で実行された場合にはエクスプローラーの「メソッド」ページを開くように内部的な仕組みが変更されました。
