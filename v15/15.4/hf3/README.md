4D v15.4 Hotfix 3
---

[4D v15.4 Hotfix 1](https://github.com/4D-JP/release-notes/tree/master/v15/15.4/hf1)および[4D v15.4 Hotfix 2](https://github.com/4D-JP/release-notes/tree/master/v15/15.4/hf2)の修正事項もご覧ください。

![jp](https://cloud.githubusercontent.com/assets/10509075/16182979/016305e0-36e7-11e6-816b-2335cc6f0abb.png)

* ACI0096073 Mac版のみ。ピクチャオブジェクト間の自動ドラッグ/ドロップ操作が完了するまでに数秒かかりました。

* ACI0096586 特定のセキュアWebサーバーに対して``HTTP Requst``でアクセスすることができませんでした。

**注記**: TLS拡張のServer Name Identification (SNI) の非サポートが原因でした（ACI0096635と同じ）。

* ACI0096608 入力不可・フォーカス不可のテキスト入力オブジェクト上でフォントピッカーまたはカラーピッカーを表示すると，アプリケーションがクラッシュしました。

* ACI0095576 Mac版のみ。``Select document``コマンドに``File name entry``と重複するファイル拡張子（``jpg``と``jpeg``など）が渡された場合，間違った拡張子が選択されたファイルに追加されることがありました。たとえば，``.jpg;.jpeg;.png;.gif``というリストが渡された場合，``PNG``ファイル（種別では2番目）に``.jpeg``という拡張子が追加されました。

* ACI0096548 Mac版のみ。ファイルサイズが0のドキュメントを``Document to text``で読み込もうとすると，``utf-8``エンコーディングを指定しない限り，error in user parameter list (paramErr) というエラーが返されました。

* ACI0096588 ``HTTP Get``をループの中で繰り返し実行していると，アプリケーションがクラッシュする場合がありました。

**注記**: ``ACI0095160``の修正が関係しています。サーバーからデータが``chunked``で返された場合の対応が正しくありませんでした。

---

* ACI0096848 ``SELECTION TO ARRAY``でオブジェクト型の配列をリストボックスに転送することを繰り返していると，メモリーリークが発生しました。``LISTBOX DELETE ROWS``, ``CLEAR VARIABLE``, ``ARRAY OBJECT (...;0)```のいずれかを実行すれば，リストボックスに表示されていたデータの占有メモリーは解放されるべきです。

* ACI0096804 フォルダー内に多数の項目が含まれる場合，``FTP_GetDirList ``が処理を完了するまで非常に時間がかかりました。以前のバージョンでは``0.250``秒ほどかかった処理が，Macでは数秒，Windowsでは数分を要しました。

* ACI0096758 ``HTTP FIXER OPTION``コマンドで``HTTP compression``を``1``に変更しても，設定が反映されませんでした。

* ACI0096819 Mac 32ビット版のみ。「メール」アプリケーションからウムラウト文字が含まれるテキストを4Dのスタイル付きテキスト入力エリア（フィールドまたは変数）にペーストすることができませんでした。他のアプリケーションでは問題ありません。

* ACI0096635 特定のWebサーバーに対して``HTTP Requst``でアクセスした場合，「404」の代わりに「#5」という内部エラーが返されました。

* ACI0096621 トランザクション内でインデックスクエリを続けて実行した場合，確定していないトランザクション中に作成されたレコードもセレクションに含まれました。インデックスクエリでなければ問題ありません。

* ACI0096771 SQLの``LEFT OUTER JOIN``の``WHERE``句に2個以上のインデックス日付フィールドが含まれると，4Dがフリーズしました。

* ACI0096576 Mac版のみ。``LAUNCH EXTERNAL PROCESS``コマンドを実行すると，``OK``変数に``0``が代入されることが稀にありました。

* ACI0096556 セレクション型のリストボックスが表示されているページから別のページに移動し，元のページに戻った場合，リストボックスのセレクションが変化していなくても，``On Display Detail``イベントが発生しました。

* ACI0096428 バージョン6.7で作成されたユーザー/グループファイル（``.4UG``）を読み込めないことがありました。サイズが17KBのときは問題ありませんが，35または39KBの場合，Windowsではクラッシュ，Macではアプリケーションが不安定になりました。データベースのアップグレードでも同じ問題が起こり得ました。

* ACI0096552 水平スクロールバーが表示された階層リストの反応が良くありませんでした。WindowsはMacよりも問題が顕著です。

* ACI0096551 Mac版のみ。アプリケーションのメインウィンドウ（スプラッシュ画面）に4Dのアイコンが表示されませんでした。「データベース設定 > 一般」で起動時モードが「アプリケーション」に設定されている場合に問題が発生します。メニューを実行してモードを切り替えた場合には問題ありません。

**注記**: 下記のファイルがビルドに含まれていなかったことが原因でした。

```
Content/Resources/Image/WindowIcons/windowIcon_205.icns
```

* ACI0096657 Windows版のみ。4Dが予期しない理由でフリーズまたはクラッシュすることがありました。再現条件ははっきりしませんが，同時に複数のクライアントが接続を解除し，その中にSQL接続が含まれている場合に発生するようです（クラッシュダンプ情報より）。

* ACI0096272 アイテムが区切り線（``-``）だけのポップアップ/ドロップダウンメニューをクリックするとアプリケーションがクラッシュしました。

* ACI0096643 フォームエディターのメニューでオブジェクトを背面に移動した場合，すぐには変更が反映されませんでした。つまり，前面に戻すことができませんでした。オブジェクトを再選択すれば，問題ありません。

* ACI0096600 Windows 32ビット版のみ。リストフォームを印刷（``XPS``プレビューを含む）すると，背景色の設定されたスタイル付きテキストの位置がずれました。

* ACI0096464 Windows版のみ。``OB GET``コマンドは，16進数表記の整数を変換しませんでした。たとえば，``0x00FFFFFF``を取り出そうとした場合，``16777215``ではなく，``0``が返されました。

```
C_OBJECT($obj)
C_LONGINT($decimal)
C_TEXT($hex)

OB SET($obj;"hex";"0x00FFFFFF")
$decimal:=OB Get($obj;"hex";Is longint) 
```

* ACI0096386 4D Server上でWebサーバーを起動した後に管理者（``Administrator``）のパスワードを変更した場合，``On Web Authentication``データベースメソッドが実行されると，以前のパスワードに戻ってしまいました。デスクトップ版では問題ありません。また，``Designer``や一般ユーザーアカウントも問題ありません。

* ACI0096595 デザインモード・ツールバーの「新規」ボタンは，メソッドエディターやフォームエディターを使用しているときでも，常に新規データベースの作成ダイアログを表示しました。エディターが開かれているときは，状況に応じ，新規テーブル・メソッド・フォームの作成ダイアログが表示されるべきです。

* ACI0096589 ``LISTBOX SET HIERARCHY``でページ2以降に配置された階層リストボックスの階層を操作した後，`` FORM GOTO PAGE``でそのページに移動しようとすると，アプリケーションが終了しました。

* ACI0094940 クイックレポートエディターを起動した後，プリントプレビューを実行すると，エディター上のラベル「レコード/セレクション」および「レコード/テーブル」が消え，それぞれ数だけが画面上に表示されました。

* ACI0096314 何もエラーが発生していない状況で``XML GET ERROR``を実行すると，アプリケーションが終了しました。

```
C_TEXT($Ref;$Error)
$Ref:=DOM Create XML Ref("my_root")
TRACE
XML GET ERROR($Ref;$Error)
DOM CLOSE XML($Ref)
```

* ACI0096560 階層リストボックスのたたまれた行に対して``EDIT ITEM``を実行した場合，その階層が表示されるようになりますが，その後，出現した分の行数だけ移動できる距離が下方向に延長されておらず，最後までスクロールすることができませんでした。

* ACI0096471 ツールボックスの「ユーザー」ページでリストボックスのヘッダーをクリックすると，ランタイムエラーが返されました。

* ACI0095975 システムテーブル``_USER_TABLES``および``_USER_COLUMNS``の内容をSQLでリストボックスに出力した場合，``TABLE_ID``, ``COLUMN_ID``など，一部の列は，ヘッダーをクリックしても並び替えが実行されませんでした。

* ACI0096136 リストボックスの水平リサイズプロパティを「拡大」に設定した場合，テキスト入力中にリストボックスをリサイズすると，編集した内容が元に戻ってしまいました。

* ACI0095160 ``HTTP Request``または``HTTP Get``でJSONテキストを受信した場合，途中でデータが切れていることがありました。HTTPヘーダー``Transfer-Encoding``が``chuncked``のときに発生します。

* ACI0096675 Mac版のみ。ODBCドライバー経由でテーブル名が正しく返されませんでした。``Table_1``の代わりに``Tbe1``が返されました。``UTF-16``エンコーディングが正しく処理されていないようです。

**注記**: 修正されたのはODBC Driverです。ドライバーをアップデートしてください。

* ACI0096649 『...と...の間』条件のクエリ設定ファイルを読み込んだ場合，開始値が終了値と同一になりました。たとえば，「2017/1/1から2017/2/2の間」という条件は「2017/2/2から2017/2/2の間」になりました。
