4D v15.4 Hotfix 1
---

(last update build ``208885``)

![jp](https://cloud.githubusercontent.com/assets/10509075/16182979/016305e0-36e7-11e6-816b-2335cc6f0abb.png)

* ACI0096250 メールの本文が32,000バイトを超過する場合，``MSG_GetBody``で全文を取り出すことができませんでした。

**注記**: 本件は，先行してInternet Commands v16（ビルド``208484``）で修正され，今回，v15にも変更が適用されました。なお，プラグインのバージョンはアプリケーション本体と一致している必要がありますが，Internet Commands v16については，v15でも使用できるよう，例外的にバージョンのチェックが省略されています。

* ACI0096189 ``SQL LOGIN``の引数を省略してログインダイアログを表示した場合，初回は正しい認証情報を入力しても接続エラー（DSNエラーであれば``9918``，そうでなければ``9921``）が返され，ダイアログが再び表示されました。同じ操作をもう繰り返すと，2度目は成功します。TCP/IPページでは問題ありません。ユーザーDSN特有の問題です。システムDSNの振る舞いは，ODBCドライバーのバージョンに左右されます。15R5では，どのDSNを指定してもローカルホストに対して接続します。 v16では，必ず接続に失敗します。

* ACI0096430 複合インデックスと非インデックスフィールドの両方が関係するクエリを実行すると，アプリケーションがクラッシュしました。v15.3では問題ありません。v15.4の不具合です。単独のシーケンシャルクエリ，および複合インデックスが利用できる``AND``クエリでは，問題ありません。両方（合計3個のフィールド）を組み合わせたクエリで問題が起きました。

* ACI0096318 Windows版のみ。リストボックスの列に収まりきらないサイズのテキストが表示されており，ワードラップが有効にされている場合，途中からテキストが表示されないことがありました。テキストが全面的に日本語であれば問題ありません。テキストに一部に英数文字が含まれていると，問題が発生します。

**注記**: 今回の修正により，Windows版のリストボックスに標準テキストを表示する方法が変更されました。セル内テキストの表示と編集（ワードラップ処理を含む）には，スタイル付きテキストと同じ方式が採用されています。

* ACI0096309 Windows版のみ。メソッドエディター内で特定の文字の組み合わせをハイライト選択すると，文字の隙間が微妙にゆらぎました。たとえば，``Ta``のように，大文字の``T``または``Y``に小文字の``a``や``e``など続く場合に問題が起きます。

**注記**: 今回の修正により，Windows版のメソッドエディターでテキストをハイライト選択する方式が変更されました。Mac版と同じように，選択中であってもなくても，テキストは__カーニング無し__で表示されます。単語と単語の間隔を一定に保つためです。しかし，文字と文字の間隔をWindowsシステムで完全にコントロールすることはできないため，場合によっては，極めて微小が差異が生じるかもしれません。Windows 7の場合，この修正が反映されるようにするためには，[プラットフォーム更新プログラム](https://www.microsoft.com/ja-jp/download/details.aspx?id=36805)の適用が必要です。

* ACI0096319 ポップアップドロップダウンメニューは，右クリックおよびコンテキストクリックにも反応し，ポップアップメニューを表示しました。このようなオブジェクトは，通常のクリックだけに反応するはずです。

* ACI0096169 ツールボックスの「リソース」ページでは，ほんの少しアイテムをドラッグ/ドロップしただけで対象がトップレベルに移動しました。

---

* ACI0095555 パレットタイプのウインドウ上でポップアップドロップダウンメニューを表示した場合，他のアプリケーションを最前面に移動した後も，ポップアップドロップダウンメニューが手前に表示され続けました。

* ACI0095970 SQLの``INNER JOIN``クエリを10万回くらい実行すると，アプリケーションが不安定になりました。メモリーリークが起きているようです。

* ACI0094057 Windows版のみ。Word文書を4D Writeで開くと，``PICT``形式以外の画像が失われました。``BMP``，``JPEG``，``PNG``，``TIFF``画像が文書に含まれていると「サポートされないイメージ形式です・というエラーが表示されます。

* ACI0096176 ブラジル・チリ・アルゼンチンの夏時間が有効になると，4Dの時間は間違った値を返しました。たとえば，「10月18日」と入力すると，「10月17日」に変換されました。

**注記**: 多くの地域とは異なり， ブラジル・チリ・アルゼンチンの夏時間は，日付が変わる深夜零時に発効します。

* ACI0096231 ``HTTP SET CERTIFICATES FOLDER``を使用せずに``HTTP Request``または``HTTP Get``でセキュアなサーバーにアクセスした場合，『無効な証明書』エラーが表示されました。

**注記**: v16では，デフォルトのSSL証明書がアプリケーション全体で使用されるように設計が見直されました。クライアント/サーバー，DB4D，SQLサーバー通信の暗号化は，いずれもアプリケーションのResourcesフォルダー内にある``cert.pem``および``key.pem``ファイルを使用しています（HTTPサーバーだけがこのファイルを使用しません）。4DのOpenSSLライブラリがこのファイルをグローバルなコンテキストで読み込んでいるため，HTTPリクエストの場合にもデフォルトで同じ証明書が使用されました。これは4Dの自己署名証明書であるため，一部のWebサーバーは要求を拒否することがあります。修正により，HTTPクライアントはデフォルトでこの証明書を使用しないようになりました。

* ACI0096312 ``4dLink``ファイルを開いた直後，ログインダイアログのパスワード入力エリアにカーソルが表示されました。期待されるのは，ログインユーザー名の入力エリアがフォーカスされることです。

**注記**: ログイン画面にユーザーリストを表示しないように設定されている場合，``4dLink``ファイルに記述されたユーザー名がリストに表示され，パスワード入力エリアがフォーカスされるようになりました。ダイアログにユーザーリストを表示するように設定されている場合，パスワード入力エリアではなく，ユーザーリストのほうがフォーカス表示されます。

* ACI0096321 Welcomeウィザードのダイアログに問題がありました。緊急アクティベーションの画面から戻った後，「戻る」ボタンのラベルが「次へ」に戻りませんでした。
