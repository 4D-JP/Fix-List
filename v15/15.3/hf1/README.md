4D v15.3 Hotfix 1
---

![jp](https://cloud.githubusercontent.com/assets/10509075/16182979/016305e0-36e7-11e6-816b-2335cc6f0abb.png)

* ACI0095582 Windows（64-bit）版のみ。入力された日本語を``backspace``または``delete``キーで削除しようとすると，最後の1文字だけ2度キーを押す必要がありました。

* ACI0095533 デザインモードに切り替えた直後，どのテーブルがカレントテーブルであっても，テーブルリスト上は第1テーブルが選択されていました。

* ACI0095625 テキスト入力エリア（フィールド/変数）のタイプが「数値」のときと「文字」のときでは，文字列のハイライト処理が違いました。数値の場合，値の手前（左）をクリックすると値全体がハイライトされるべきですが，プロパティリストの変数タイプが「文字」に設定されていると，たとえオブジェクトにバインドされたデータソース（フィールド/変数）の型が数値であっても，テキストのようにハイライトされました。つまり，文字列の左端にカーソルが表示されました。

* ACI0095885 テキスト入力のプロパティが「入力不可」に設定されており，垂直スクロールバーが設定されていない場合，水平スクロールを操作することができませんでした。「フォーカス化」または「垂直スクロールバー」が設定されていれば問題ありません。

* ACI0095832 Windows版のみ。日本語変換中，``return``キーを押さずにタイプを続けると，未確定の変換文字列が消えました。

* ACI0095633 データベース設定 > インタフェース > でスプラッシュスクリーンでアプリケーションモードのプロセスウインドウを非表示に設定した場合，オブジェクトがフォーカスされていないにも関わらず，編集メニューがアクティブになりました。そのため``control+A``のキーボードショートカットをメニューで処理することができませんでした。

---

###macOS Sierra

* ACI0096150 macOS 10.12 Sierraのみ。4D Writeエリアをクリックするとアプリケーションがクラッシュしました。

* ACI0096062 macOS 10.12 Sierra (16C48B, 16B255) のみ。コンボボックスのドロップダウンメニューをクリックすると，メニューが``Moveable form dialog box``タイプのウインドウの背面に移動しました。

* ACI0095935 macOS 10.12 Sierraのみ。ビルドしたアプリケーションのZIP圧縮ファイルをインターネット経由でダウンロードした場合，展開したアプリケーションを起動すると「エラーダイアログがロードできません。ファイル属性の変更ができません」という趣旨のエラーが表示されました。

**注記**: macOS 10.12 Sierraでは，ダウンロードしたアプリケーション（ZIP圧縮またはディスクイメージ）を「アプリケーション」フォルダーに移動せず，そのまま実行した場合，書き込み禁止の隔離された場所にアプリケーションが移されるようになっています（トランスロケーション）。展開したアプリケーションを移動せずに起動した場合，アプリケーションがリードオンリーモードで起動するのは正常なことです。今回の問題は，アプリケーションが自らを書き換えようとしていたことであり，それは修正されました。

* ACI0096050 macOS 10.12 Sierraのみ。PICT形式の画像を``.jpg``または``.png``に変換しようとすると，アプリケーションがクラッシュしました。

* ACI0096051 macOS 10.12 Sierraのみ。``PICT``形式の画像をファイルに保存しようとすると，アプリケーションがクラッシュしました。

* ACI0096021 macOS 10.12.1 (16B2657) のみ。ライセンス更新ダイアログで更新ボタンをクリックすると，アプリケーションがクラッシュしました。データベース設定ダイアログでも，似たような問題が発生します。

* ACI0095973 macOS 10.12.1 (16B2657) のみ。フォームエディターのプロパティリストをクリックするとアプリケーションがクラッシュしました。

* ACI0096006 macOS 10.12.1 (16B2657) のみ。[WP Get selection](http://doc.4d.com/4Dv16/4D/16/WP-Get-selection.301-3036236.ja.html)を実行しようとすると，アプリケーションがクラッシュしました。

---

* ACI0095714 Mac版のみ。フィールドの値がアクセント記号（``è``, ``é``, ``ä``など）で終わる場合，ODBC経由でそのようなデータをSQLで外部データソースに``INSERT``すると，エラー``9922``が返されました。

**注記**: ``Begin SQL``/``End SQL``構文内で``<<[mytable]myfield>>``フィールド表記を使用した場合に問題が発生します。 変数や配列の参照（``:$variable``）であれば問題ありません。

* ACI0095844 クライアント側のメニューからインタープリターモードまたはコンパイルモードに切り替えてサーバーアプリケーションを再起動すると，クライアント側で4D Write Proのライセンスが認識されなくなりました。

* ACI0095853 デザインモードの検索で数万件のオブジェクトがヒットするような条件を入力すると，しばらくアプリケーションがハングしたような状態になり，デザインモードを操作することができませんでした。

**注記**: 検索の速度ではなく，結果を階層リストに表示するための仕組みに問題がありました。

* ACI0095911 ``SMTP_QuickSend``で送信できるメール本文のサイズにコンパイルモードで制限がありました。画像が含まれる4D Write Pro文書をMIMEモードで書き出した場合，画像データがBase64エンコードされるために本文のサイズが32,000バイトを超えることは少なくありません。修正により，32,000バイトを超えるメールも送信できるようになりました。

* ACI0094581 コンパイルモードで``QUERY([table];[table]field;*)``という構文のコードを実行するとアプリケーションがクラッシュしました。

* ACI0095232 [BLOB TO USERS](http://doc.4d.com/4dv15r/help/command/ja/page850.html)でストラクチャにユーザー情報をインポートすることができませんでした。

* ACI0088073 プロセスでトランザクションを開始してロードした「リレートしたNレコードを削除」オプションが有効にされたレコードを削除した後にトランザクションをキャンセルした場合，そのプロセスが動作している間は，新規プロセスから前のプロセスがロックしたセレクション内のレコードを削除することができませんでした。

**注記:** [リレートしたNレコードを削除](http://doc.4d.com/4Dv16/4D/16/Relation-properties.300-3048985.ja.html)オプションが有効にされている場合，データベースエンジンは内部的にトランザクションを開始し，セレクションの削除を試みます。しかし，これをトランザクション内で実行した場合，トランザクションをキャンセルしても，内部的に開始された第2段階のトランザクションがロックしたレコードがプロセスによってロックされたままになりました。つまり，第2段階のトランザクション内でレコードを削除してから第2段階のトランザクションを確定し，第1段階のトランザクションをキャンセルした場合，削除を取りやめたレコードがそのプロセスによってロックされたままになる，という問題がありました。

```
START TRANSACTION
START TRANSACTION
QUERY([configs];[configs]id=2)
DELETE SELECTION([configs])
VALIDATE TRANSACTION 
CANCEL TRANSACTION
```

* ACI0095804 MSCでアドレステーブルを圧縮せずにデータファイルを圧縮した直後，アドレステーブルの圧縮を含めてデータファイルを圧縮すると，アプリケーションがクラッシュしました。新規データベースでは再現しません。レコードの作成や削除を繰り返したデータファイルでは再現します。

* ACI0091658 [SET TABLE TITLES](http://doc.4d.com/4dv15r/help/command/ja/page803.html)でテーブルタイトルを設定した後，クエリエディターを表示した場合，マスターテーブルにN対1リレーションが定義されていると，余計な空のテーブル名（``[]``）が表示されました。

* ACI0091900 データベース間で入力フォームを移動した場合，ヘルプTipsが一緒に移動しませんでした。

* ACI0094807 [On SQL Authentication](http://doc.4d.com/4Dv16/4D/16/On-SQL-Authentication-database-method.301-3037171.ja.html)データベースメソッドの``$3``にはクライアントではなくホストのIPアドレスが返されました。

* ACI0095610 ウイルス退治ソフトウェア（McAfeeなど）により，自動アップグレードが阻まれることがありました。

**注記**: [Process Monitor](https://technet.microsoft.com/ja-jp/sysinternals/processmonitor.aspx)でファイルアクセスを監視すると，自動アップデート中にMcAfeeが一瞬だけ4DCファイルにアクセスしていることが確認できます。終了直前に4DCファイルが書き換えられることに反応しているようです。ファイルがロックされているため，古いアプリケーションを移動することができず，自動アップグレードに失敗しました。

* ACI0095739 ポップアップウインドウ表示中にデバッガを表示しようとすると，アプリケーションがフリーズしました。

**注記**: 技術的な制約により，ポップアップウインドウの前面にデバッガを表示することはできません。ポップアップメニューやヘルプTipsなども，常にデバッガの前面に表示されます。修正により，フリーズの問題は解消されましたが，ポップアップウインドウの背面にデバッガが表示されることには変わりません。

* ACI0095877 Mac版のみ。``option``キーを押しながら``delete``キーを入力した場合，カーソル位置の前にある単語が削除されるはずですが，単語の最後の1文字が削除されずに残りました。

* ACI0096001 Mac版のみ。v15 R5で4D Write Proウィジェットが追加されたフォームをv15で開こうとすると，アプリケーションがクラッシュしました。

* ACI0095854 [HTTP Get ](http://doc.4d.com/4dv15r/help/command/ja/page1157.html)は，特定の場合にテキストファイルを受信することができませんでした。

**注記**: 文字コードが不明な場合，テキスト型ではなBLOB型でファイルを受信したほうが無難です。

* ACI0095992 4D v6.8で作成されたクイックレポートを開いた場合，クイックレポートエディターを閉じようとしたタイミングでアプリケーションがクラッシュしました。v14で再保存したレポートであれば問題ありません。

* ACI0095812 特定のケースで[WEB SERVICE CALL](http://doc.4d.com/4dv15r/help/command/ja/page778.html)がクラッシュを誘発することがありました。

* ACI0095819 コンパイルモードでブール型の評価が間違っていることがありました。たとえば，下記のコードは``True ``になるはずですが``False``が返されました。

```
C_BOOLEAN(vv)
vv:=True | False
```

* ACI0094976 圧縮されたBLOBがWebサービスから返された場合，BLOBは正しく展開されず，データのサイズが``0``でした。

* ACI0095925 Mac版のみ。シートウインドウ上にコンボボックスのポップアップメニューが表示されているタイミングでデバッガを表示すると，デバッガを閉じた直後にアプリケーションがクラッシュしました。ポップアップドロップダウンメニューであれば問題ありません。

* ACI0095981 Mac版のみ。旧ラベルエディターで「ファイルを開く・ダイアログを閉じた後，エディター自体もを終了した場合，空のウインドウが画面上に残されました。``SHOW PROCESS``を実行すると，そのウインドウを呼び出すことができます。

* ACI0094884 [OpenlinkのJDBC-ODBCブリッジ](https://uda.openlinksw.com/jdbc-odbc-st/)と合わせて4D ODBC Driverを使用した場合，一部のローレベルODBCコマンド（``SQLGetInfoW``, ``SQLGetTypeInfo``, ``SQLDescribeCol``）で問題が発生しました。これらのODBCコマンドは，ODBC 3.x（1996年）で追加されたものです。

* ACI0096018 Mac版のみ。SVGで``Arial Black``フォントが使用されていた場合，フォントがインストールされていても``Times``が代わりに表示されました。

* ACI0095198 4D Viewのコマンド``PV Create picture``で作成したピクチャーは，透過ピクセルの処理が正しくありませんでした。

**注記**: これには仕様上の制約が関係しています。``PV Create picture``はベクトル画像（Windowsは``.emf``，Macは``PICT``）を出力しますが，それらの形式は透明属性をサポートしていません。問題を回避するため，``ignoreEmptyCells``引数のビット1が「空ピクセルを無視」という特別な意味を帯びるようにコマンドが調整されました。

元がベクトル画像であれば，``0``で空ピクセルを無視しない，``1``で空ピクセルを無視する，という指定になります。元がビットマップ画像であれば，``2``で空ピクセルを無視しない，``3``で空ピクセルを無視する，という指定になります。なお，Mac版で背景がブラックになる問題も合わせて修正されました。

* ACI0095452 Mac版のみ。クイックレポートエディター上でセルを選択した直後，ツールバーが更新されませんでした。

* ACI0095543 Windows 10のみ。``AP Print settings to BLOB``を実行するとアプリケーションがクラッシュしました。一度クラッシュすると，Windowsを再起動するまでクラッシュは再発しません。

* ACI0095780 Mac版のみ。一部のPDF（スキャナーで取り込んだ後に「プレビュー」で回転させたものものなど）は，用紙の縦と横が誤って表示されました。

* ACI0095967 Windows版のみ。非常に古いバージョンで作成された``PICT``画像を4D Writeにコピー/ペーストした場合，枠だけが表示されました。データは残っているようで，``.png``形式に変換すると画像が復元されます。

* ACI0095992 v6.8で作成されたクイックレポートを読み込んだ場合，レポートは開くことができますが，9エディターを閉じたタイミングでアプリケーションがクラッシュしました。v14であれば，問題なく同じレポートを開くことができます。また，v14で保存し直した後は，v15でも開くことができるようになります。

* ACI0096053 Windows版のみ。4D Viewのツールバーにあるフォーミュラーエディターが黒く表示されました。

* ACI0095746 [SET DATABASE PARAMETER](http://doc.4d.com/4Dv16/4D/16/SET-DATABASE-PARAMETER.301-3036270.ja.html)に定数``Circular log limitation``と値``1``は，ログ（サーバーリクエストログ・Webログ・デバッグログ・クライアントリクエストログ・診断ログ）作成を有効にした後でなければ，ログファイル数の最大値を制限しませんでした。

* ACI0096082 数値フィールドにフォーマットが適用されており，値の桁数がフォーマットの桁数に満たない場合，水平揃えが常に「右揃え」になりました。

* ACI0095686 v13で作成したクエリ定義ファイル（拡張子``.4df``）が開けないことがありました。

* ACI0095237 [Convert path system to POSIX](http://doc.4d.com/4Dv16/4D/16/Convert-path-POSIX-to-system.301-3036724.ja.html)は``#``を``%23``に変換しませんでした。

* ACI0095681 リストボックスのセルの背景色は，透過に設定されていても，テキスト入力中はホワイトになりました。
