4D v15.3
---

###macOS 10.12 Sierra 互換性問題について

Appleは，2016年10月24日（``16B2555``）に続き，2016年10月27日（``16B2557``）にもmacOS 10.12.1をリリースしました。4D v15.3は，初めにリリースされたほうのSierraで互換性検証に合格し，リリースの準備が進められてきました。ところが，一部のSierraユーザーから頻繁に4Dがクラッシュするという報告があり，調査しましたところ，いずれも__27日にリリースされたほうのSierraで問題が発生している__ことが判明しました。

なお，24日のmacOSアップデートを済ませた場合，27日にはアップデートの通知がなされませんので，El CapitanからアップデートしたMacで不具合が発生するmacOS 10.12.1を使用しているユーザー数は限られていると思われます。一方，App StoreまたはAppleのサポートサイトから現在ダウンロードできるバージョンは，27日のバージョンとなっています。

https://support.apple.com/kb/dl1897?locale=ja_JP

**参考**：[Mac で macOS のバージョン番号を調べる](https://support.apple.com/ja-jp/HT201260)

**ヒント**：バージョン番号をクリックすると、ビルド番号が表示されます。

開発者向けに公開されているベータ版では，かなりの改善がみられており，macOS 10.12.2に期待が持たれています。4Dでは，これ以上Sierraの対応を先延ばしにするのではなく，当面，__正式に対応しているのは，2016年10月24日にリリースされたmacOS 10.12.1（``16B2555``）と限定__させていただき，その後，macOS 10.12.2が正式にリリースされたときに改めて包括的な互換性の検証を実施したいと考えています。

Macユーザーの皆様には，ご不便をおかけいたしますが，事情をご理解いただければ幸いです。

---

[4D v15.2 Hotfix 2](https://github.com/4D-JP/release-notes/tree/master/v15/15.2/hf2)および[Hotfix 1](https://github.com/4D-JP/release-notes/tree/master/v15/15.2/hf1)の修正事項は，それぞれのページに掲載されています。

* ACI0095961 [Get selected menu item parameter](http://doc.4d.com/4dv15r/help/command/ja/page1005.html)は，常に空の文字列を返しました。15.2までは問題ありませんでした。

* ACI0095890 macOS 10.12 Sierraのみ。クイックレポートのように，モーダルかつ移動できるウインドウからオペレーションシステム標準のファイル選択ダイアログを表示している間に，デスクトップなどをクリックすると，モーダルウインドウがファイル選択ウインドウよりも前面に移動してしまい，ファイル選択ダイアログが操作できなくなりました。64ビット版の4Dでは問題ありません。

* ACI0095879 macOS 10.12 Sierraのみ。パレットウインドウには，閉じる/隠すボタンが表示されませんでした。ボタンのあるべき位置をクリックすれば反応がありますが，コントロールの画像が表示されませんでした。

**注記**: 32ビット版アプリケーションの問題です。パレットウインドウは，タイトルが存在しない場合，タイトルバーがさらに細く描画されました。El Capitan以前は，それでもボタンコントロールが部分的に描画されました。Sierraでは，そのような場合，ボタンコントロールがまったく描画されないようになったようです。修正により，空の文字列がウインドウタイトルに設定されるようになりました。なお，64ビット版では，タイトルの有無によってタイトルバーの幅が変動しないため，問題が発生しません。

* ACI0093502 4D Remoteを終了しようとするとき，DB4D CRONタスクが終了待ちであるという英文のアラート画面が表示されました。

**注記**: アラートは，一定時間以内に終了プロセスが完了されなかった場合に表示されます。修正により，その待ち時間は3秒から5秒に延長されました。また，データが破損するかもしれないという警告文（"you may damage your data)"）が取り除かれました。

* ACI0094466 [MESSAGES OFF](http://doc.4d.com/4dv15r/help/command/ja/page175.html)コマンドを使用しても，[BUILD APPLICATION](http://doc.4d.com/4dv15r/help/command/ja/page871.html)コマンドのメッセージは抑制できませんでした。

* ACI0095342 64ビット版のみ。4D ServerのMSC画面では，[上級モードの圧縮](http://doc.4d.com/4Dv15R5/4D/15-R5/Compact-page.300-2964274.ja.html)（レコードを強制的に更新・アドレステーブルの圧縮）ができませんでした。``Replaced Files (compacting)``フォルダーは作成されますが，中身は空です。ログファイルやイベントビューアには何も情報が書き込まれません。

**注記**: 圧縮を実行するためには，破損していないデータベースであることが必要です。MSCの検査でインデックスの破損が検出される場合，圧縮はできません。そのような場合，まずデータファイルの修復を実行してください。それとは別に，ジャーナルファイルがみつからない場合，圧縮が中断されるという問題がありました。修正により，ジャーナルファイルがみつからなくても，圧縮ができるようになりました。

* ACI0095738 v13から変換されたデータベースでは，[Print form](http://doc.4d.com/4dv15r/help/command/ja/page5.html)で垂直の極細線が印刷できませんでした。[PRINT SELECTION](http://doc.4d.com/4dv15r/help/command/ja/page60.html)では問題ありません。新しく描画した垂直の極細線でも問題ありません。

* ACI0095759 Mac版のみ。クエリエディターでリレートテーブルを参照するクエリが実行できませんでした。

* ACI0095768 Mac版のみ。カスタムマクロに設定されたショートカットが動作しませんでした。

**注記**: 以前のバージョンでは，カスタムマクロの名称に続けてスラッシュ記号を記述することにより，ショートカットを設定することができました。（例: ``/t``）これは，Carbonのメニューアイテムタイトルのメタキャラクター解析によるメカニズムであり，意図された仕様ではありませんでした（非ドキュメント）。修正はされましたが，将来のバージョンでは，XML属性でキーボードショートカットが設定できるよう仕様が明確にされる予定です。なお，Windows版（Altura）では，小文字のメタ文字（例: ``/t``）は``Shift``キーの併用を意味することになります（例: ``Control+Shift+T``）。``Shift``キーを伴わない単純なショートカットであれば，大文字のメタ文字（例: ``/T``）を記述する必要があります。

* ACI0095772 開かれたデータベース間でオブジェクトメソッドの記述されたリストボックスをドラッグ＆ドロップ操作でコピーした場合，コピー先メソッドの関連付けが正しくありませんでした。アプリケーションの検査を実行すると，同じメソッドが複数のオブジェクトに関連付けられているというエラーが検出されます。

* ACI0095847 Windows 10（1607）のみ。印刷プレビューが表示されないことがありました。

* ACI0095496 SQLコマンドでリストボックスに列を追加した場合，列フィールドがREAL型であってもフッター変数はLONGINT型で作成されました。そのため，フッターの計算が正しくありませんでした。コマンドで列を追加した場合は，フッター変数の型を変換する方法がありますが，SQLで追加した列には使用できませんでした。

* ACI0095618 リストボックスにロックされた列が存在する場合，垂直スクロールバーが動作しないことがありました。

* ACI0095686 以前のバージョンで作成されたクエリ定義ファイル（拡張子``4QF``）に含まれる情報が読み込めませんでした。空のエラーダイアログが表示されます。

* ACI0084603 開かれたデータベース間でメソッドをドラッグ＆ドロップ操作でコピーした場合，テーブル名ではなくテーブル番号でテーブル参照が解釈されるため，意図しないテーブルのコードが書き換わることがありました。[移動](http://doc.4d.com/4Dv15R5/4D/15-R5/Moving-page.300-2964106.ja.html)のデータベース設定で「他のオブジェクトを使用」または「無視」が選択されており，メソッド内に複数のテーブル参照が存在する場合に問題が発生します。

* ACI0093475 メソッドエディターに``Process state($proc_i)``と記述した後，の文字からなる演算子（例: ``>=``）を入力すると，タイプアヘッドにより提案された文字列（例: ``Aborted``）が演算子の1文字目を置換しました。

**注記**: 修正により，演算子``>``と``<``の補完候補は表示されないようになりました。

* ACI0093548 Windows版のみ。リストボックス上で垂直スワイプ（2本指）のジェスチャーをしても，スクロールが実行されませんでした。対照的に，ピンチ/ズーム（2本指）のジェスチャーで垂直スクロールが実行されます。つまり，ジェスチャーとスクロールのマッピンクが間違っています。

* ACI0094056 ごみ箱にフォームが存在する状態でビルドされたアプリケーションは，MSCでアプリケーションの破損が検出されます。フォームをごみ箱から復元するか，ごみ箱を空にすれば，エラーが消えます。

* ACI0095490 Macのクライアントから64ビット版のWIndowsサーバーに対する接続を繰り返していると，ランタイムエラー``-50``が返されることがありました。

* ACI0084580 開かれたデータベース間で複数のプロジェクトメソッドが含まれるフォルダーをドラッグ＆ドロップ操作でコピーした場合，意図しないテーブルのトリガが書き換わることがありました。直接メソッドを移動すれば問題が発生しません。

* ACI0095459 Mac版のみ。[PV EXECUTE COMMAND](http://doc.4d.com/4dv15r/help/command/ja/page15989.html)の実行後，4D Viewエリアが再描画されませんでした。

* ACI0095739 ポップアップメニューを表示中にデバッガを表示すると，アプリケーションがフリーズしました。

* ACI0095327 同一マシン上で別の4DがTLSモードでサーバーを公開している場合，通常のポート番号（例: ``8080``）でWebサーバーを開始することができませんでした。
